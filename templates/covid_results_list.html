<html>
  <head>
    <title>Display Covid 19 Image</title>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../static/css/styles.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  </head>
  <body>
    <div class="main">
      <div class="row">
        <div class="header col-lg-12 col-md-12 col-sm-12 text-center">
          <h2 style="text-transform: uppercase;">MASKSHIELD DETECTION SYSTEM</h2>
        </div>
      </div>
      <div class="container">
        <div class="row">

        <div class="message-top col-lg-12 col-md-12 col-sm-12 text-center">
          <h4>Please upload COVID-19 related images.</h4>
          <span>
            Note the model is running on CPU. Works best on Single person.</span
            >
        </div>
        <div id="form_box" class="form col-lg-12 col-md-12 col-sm-12 text-center">
          <form enctype="multipart/form-data" method="post">
            <input
              type="file"
              id="avatar"
              name="file1"
              accept="image/png, image/jpeg"
            />
            <input type="submit" />
          </div>
        </form>
      </div>
      <section class="row display-images">
        <div class="source-image col-lg-6 col-md-6 col-sm-6">
          <img
            width="540px"
            height="720px"
            src="{{source_image}}"
            alt="Images"
          />
        </div>
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div class="summary">

            <div class="chart">
              <h4 style="color: #7272ff!important; font-weight: 600; margin-bottom: 20px; text-transform: uppercase;" class="safety-indicator text-center">COVID-19 Safety Index</h4>
              <canvas id="myChart"></canvas>
            </div>

            <div class="detection-summary" style="margin-top:30px;">
              <h4 >Analyzed Summary</h4>
              {% for key in detected_category %}
              <p class='summary-key-value'> <span class='summary-key'>{{key}}: </span>
             
                <span class="detect_{{detected_category[key][0]}}"> {{detected_category[key][1]}}</span>
            
              </p>
              {% end %}
            </div>

          </div>
 
        </div>
      </section> 

      <!-- <section class="detected-images">
        <div class="heading-title text-center">
          <h4 style="color: #7272ff!important; margin-top: 40px; font-weight: 600; text-transform: uppercase;">Analyzed Images</h4>
        </div>
        <div class="row">
            {% for key in destination_image %}
              <div class="detected-image" style="width:220px; text-align: center;">
                <img
                class="small-image"
                width="160px"
                height="120px"
                src="{{destination_image[key]}}"
                alt="Images"
                />
                <div style="text-transform: uppercase; text-align: center;  margin-top: 20px; font-weight: 600;">{{key}}</div>
              </div>
            {% end %}
        </div>
      </section> -->
    </div>

   <section class="container-fluid">
      <div class="heading-title text-center">
        <h4 style="color: #7272ff!important; font-weight: 600; text-transform: uppercase;">Recently Analyzed</h4>
      </div>

      <div class="row detection_history">
        {% for key in detection_history %}
          <div class="col-lg-3 col-md-3 col-sm-3 text-center">
            <img
              width="300px"
              height="400px"
              class="{{key}}"
              src="{{detection_history[key]['image_path']}}"
              alt=""
            />
            <div class="row">
              <div class="detection">
                <div class="detection-left">
                  <div><span class="detection_{{detection_history[key]['detect_mask']}}"></span><span class="detection-item">Masks </span></div>
                  <div><span class="detection_{{detection_history[key]['detect_faceshield']}}"></span><span class="detection-item">Face Shield </span> </div>
                </div>
              </div>
            </div>
          </div>
          {% end %}
      </div>
    </section>
    <div class="footer">
      <h6>Copyright 2020 Saugat Bhattarai. All Rights Reserved</h6>
    </div>
    </div>
  </body>
  <script>
    var ctx = document.getElementById('myChart').getContext('2d');
    var data = "{{safety_percentage}}";
    var new_data = parseInt(data, 10)
    new_data = [new_data, 2 - new_data]

    var chart = new Chart(ctx, {
        // The type of chart we want to create
        type: 'doughnut',

        // The data for our dataset
        data: {
            labels: [
                'Detected',
                'Not Detected'
            ],
            datasets: [{
                label: 'Covid Safety Index',
                backgroundColor: [
                  'rgb(76, 186, 91, 0.5)',
                  'rgb(222, 91, 107, 0.5)'
                ],
                borderColor: [
                  'rgb(76, 186, 91, 1)',
                  'rgb(222, 91, 107, 1)'
                ],
                borderWidth: 1,
                data: new_data
            }]
      },

      // Configuration options go here
      options: {}
    });
  </script>
</html>
